Example 09 – Using execl() to Replace a Process Image
Purpose

This example demonstrates how a child process can replace its own program image with a completely new program using the execl() system call.
Here, the child replaces itself with the /bin/ls command to list directory contents.

Key Concepts

fork() creates a new process (child).

execl() replaces the process image with a new program.

After a successful execl(), the original code in the process is no longer executed.

The parent can still wait for the child to finish using wait() and retrieve its exit status.

System Calls / Functions Used

fork() – create a child process.

execl() – replace the current process image.

getpid() – get the process ID of the calling process.

getppid() – get the parent process ID.

wait() – wait for the child to finish.

WIFEXITED() / WEXITSTATUS() – check how the child exited.

printf(), perror() – output and error reporting.

exit() – terminate the process.

How It Works

The program starts and prints the parent process PID.

fork() is called to create a child process.

Child process (pid == 0):

Prints its PID and PPID.

Calls execl("/bin/ls", "ls", "-l", (char *)NULL); to replace itself with the ls -l program.

If successful, the child process image is replaced, and the ls -l output appears on the screen.

Any code after execl() in the child is not executed unless execl() fails.

Parent process (pid > 0):

Prints its PID and the child PID.

Calls wait(&status) to wait for the child process to finish.

After the child terminates, it checks the exit status using WIFEXITED() and WEXITSTATUS().

The parent prints the child’s exit status and then exits itself.

Observations

The child process no longer executes its original code after execl().

The ls -l output is generated by the child process replacing itself.

The parent waits and ensures proper synchronization, then prints the child’s exit status.

How to Compile and Run
gcc main.c -o app
./app


Steps:

Navigate to the folder containing main.c.

Compile with gcc main.c -o app.

Run ./app.

Observe the child process PID and PPID, the ls -l output, and the parent printing the child's exit status.
